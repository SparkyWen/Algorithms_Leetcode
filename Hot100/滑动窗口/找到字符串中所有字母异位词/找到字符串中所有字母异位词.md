# æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯

## 1. çŸ¥è¯†ç‚¹

### 1. æ ¸å¿ƒæ€è·¯

==**æ ¸å¿ƒæœ¬è´¨å°±æ˜¯åŒå‘åŒæŒ‡é’ˆ**==

è®¾ *n* æ˜¯ *p* çš„é•¿åº¦ã€‚æœ¬é¢˜æœ‰ä¸¤ç§åšæ³•ï¼š

**å®šé•¿æ»‘çª—ã€‚**æšä¸¾ s çš„æ‰€æœ‰é•¿ä¸º n çš„å­ä¸²s^'^ï¼Œå¦‚æœ s^'^çš„æ¯ç§å­—æ¯çš„å‡ºç°æ¬¡æ•°ï¼Œå’Œ p çš„æ¯ç§å­—æ¯çš„å‡ºç°æ¬¡æ•°éƒ½ç›¸åŒï¼Œé‚£ä¹ˆs^'^æ˜¯ p çš„å¼‚ä½è¯ã€‚

**ä¸å®šé•¿æ»‘çª—ã€‚**æšä¸¾å­ä¸²s^'^çš„å³ç«¯ç‚¹ï¼Œå¦‚æœå‘ç°s^'^å…¶ä¸­ä¸€ç§å­—æ¯çš„å‡ºç°æ¬¡æ•°å¤§äº p çš„è¿™ç§å­—æ¯çš„å‡ºç°æ¬¡æ•°ï¼Œåˆ™å³ç§» s^'^çš„å·¦ç«¯ç‚¹ã€‚å¦‚æœå‘ç°s^'^çš„é•¿åº¦ç­‰äº p çš„é•¿åº¦ï¼Œåˆ™è¯´æ˜s^'^çš„æ¯ç§å­—æ¯çš„å‡ºç°æ¬¡æ•°ï¼Œå’Œ p çš„æ¯ç§å­—æ¯çš„å‡ºç°æ¬¡æ•°éƒ½ç›¸åŒï¼ˆå¦‚æœå‡ºç°æ¬¡æ•°s^'^çš„å°äº p çš„ï¼Œä¸å¯èƒ½é•¿åº¦ä¸€æ ·ï¼‰ï¼Œé‚£ä¹ˆs^'^æ˜¯ p çš„å¼‚ä½è¯ã€‚

==ä¸ºä»€ä¹ˆä¸ç”¨å·¦ç«¯ç‚¹ï¼Œå› ä¸ºå·¦è¾¹ä¸å¤Ÿç›´æ¥==

### 2. æ»‘åŠ¨çª—å£æ¨¡æ¿

#### ä¸€ã€æ»‘åŠ¨çª—å£ = æ¨¡æ¿ + 4 ä¸ªé—®é¢˜

æ‰€æœ‰ç»å…¸æ»‘åŠ¨çª—å£é¢˜ï¼ŒåŸºæœ¬éƒ½å¯ä»¥å½’ç»“ä¸ºï¼š

> ç»´æŠ¤ä¸€ä¸ªåŒºé—´ `[left, right]`ï¼Œ
>  ä¸€è¾¹å‘å³ç§»åŠ¨ `right` æ‰©å¼ çª—å£ï¼Œ
>  ä¸€è¾¹åœ¨å¿…è¦æ—¶ç§»åŠ¨ `left` ç¼©å°çª—å£ï¼Œ
>  å¹¶åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æ›´æ–°ç­”æ¡ˆã€‚

å†™ä»£ç å‰ï¼Œä½ åªè¦æŒ‰è¿™ä¸ªé¡ºåºå›ç­” 4 ä¸ªé—®é¢˜ï¼š

1. **çª—å£é‡Œé¢æ˜¯ä»€ä¹ˆï¼Ÿ**

   - æ¯”å¦‚ï¼šå½“å‰è€ƒè™‘çš„å­ä¸² `s[left:right+1]`ã€‚

2. **ä»€ä¹ˆå«â€œçª—å£åˆæ³• / æ»¡è¶³æ¡ä»¶â€ï¼Ÿ**

   - ä¾‹å¦‚ï¼š
     - æ— é‡å¤å­—ç¬¦ï¼šçª—å£é‡Œæ¯ä¸ªå­—ç¬¦å‡ºç°æ¬¡æ•° â‰¤ 1
     - å¼‚ä½è¯ï¼šçª—å£é•¿åº¦ = len(p)ï¼Œå¹¶ä¸”æ¯ä¸ªå­—ç¬¦é¢‘ç‡å’Œ p ä¸€æ ·
     - æ€»å’Œ â‰¤ kã€ä¸åŒå­—ç¬¦æ•° â‰¤ Kï¼Œç­‰ç­‰

3. **å½“å³ç«¯ç‚¹ `right` å¾€å³èµ°ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œæˆ‘éœ€è¦æ€æ ·æ›´æ–°çŠ¶æ€ï¼Ÿ**

   - ä¸€èˆ¬å°±æ˜¯ï¼š

     ```
     right += 1
     æŠŠ s[right] åŠ è¿›çª—å£ï¼šadd(s[right])
     ```

   - å¯¹åº”åˆ°ä»£ç ï¼š`cnt[s[right]] += 1` / `window.add(...)` ç­‰

4. **å½“çª—å£ä¸åˆæ³•æ—¶ï¼Œleft æ€ä¹ˆç§»åŠ¨ï¼Ÿç§»åŠ¨æ—¶çŠ¶æ€æ€ä¹ˆæ›´æ–°ï¼Ÿ**

   - æ¯”å¦‚ï¼š
     - æ¡ä»¶ï¼š`æŸä¸ªè®¡æ•° > 1` â†’ `while` é‡Œä¸æ–­ `left += 1`ï¼Œå¹¶ `remove(s[left])`
   - å¯¹åº”ä»£ç ï¼š`cnt[s[left]] -= 1` / `window.remove(...)`

**æœ€åä¸€ä¸ªé—®é¢˜ï¼šä»€ä¹ˆæ—¶å€™æ›´æ–°ç­”æ¡ˆï¼Ÿ**

- **æ‰¾æœ€å¤§é•¿åº¦** â†’ ä¸€èˆ¬åœ¨â€œ`while` ç¼©å®Œã€çª—å£æ¢å¤åˆæ³•ä¹‹åâ€æ›´æ–° `ans = max(ans, right-left+1)`
- **æ‰¾æœ€å°é•¿åº¦** â†’ ä¸€èˆ¬åœ¨â€œçª—å£åˆšåˆšåˆæ³•çš„é‚£ä¸€åˆ»â€æ›´æ–°ï¼Œç„¶åé©¬ä¸Šæ”¶ç¼©

------

#### äºŒã€é€šç”¨æ¨¡æ¿ 1ï¼šä¸å®šé•¿çª—å£ï¼ˆæœ€é•¿ç±»ã€æœ€çŸ­ç±»ï¼‰

> åœºæ™¯ï¼šæœ€é•¿æ— é‡å¤å­ä¸²ã€æœ€é•¿æ»¡è¶³æŸç§é™åˆ¶çš„å­æ•°ç»„â€¦â€¦

##### Python éª¨æ¶ï¼ˆä½ å¯ä»¥èƒŒä¸‹æ¥ï¼‰

```
left = 0
ans = 0  # æˆ–è€…åˆ«çš„å½¢å¼
window = ...  # æ¯”å¦‚ Counter(), dict(), set()

for right, ch in enumerate(s):
    # 1. å³ç«¯ç‚¹è¿›å…¥çª—å£
    add(ch, window)  # ä¾‹å¦‚ window[ch] += 1

    # 2. å¦‚æœçª—å£ä¸åˆæ³•ï¼Œå°±æ”¶ç¼©å·¦ç«¯ç‚¹ç›´åˆ°é‡æ–°åˆæ³•
    while not is_valid(window):
        remove(s[left], window)  # ä¾‹å¦‚ window[s[left]] -= 1
        left += 1

    # 3. ç°åœ¨çª—å£åˆæ³•ï¼Œå°è¯•æ›´æ–°ç­”æ¡ˆï¼ˆæœ€é•¿é•¿åº¦ï¼‰
    ans = max(ans, right - left + 1)

return ans
```

ä½ è¦åšçš„å°±æ˜¯å¡«ä¸‰ä¸ªä¸œè¥¿ï¼š

1. `window` ç”¨ä»€ä¹ˆå­˜ï¼ˆ`set` è¿˜æ˜¯ `Counter` / dict / æ•°ç»„ï¼‰
2. `add` / `remove` æ€ä¹ˆå†™
3. `is_valid(window)` è¡¨è¾¾ä»€ä¹ˆæ¡ä»¶

------

#### ä¸‰ã€ç”¨è¿™ä¸ªæ¨¡æ¿æ¨å¯¼ï¼šâ€œæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²â€

é¢˜æ„ï¼šæœ€é•¿å­ä¸²ï¼Œ**å†…éƒ¨æ²¡æœ‰é‡å¤å­—ç¬¦**ã€‚

##### ç¬¬ 1 æ­¥ï¼šç¡®å®šçª—å£å«ä¹‰

- çª—å£ = å½“å‰è€ƒè™‘çš„å­ä¸² `s[left:right+1]`ã€‚

##### ç¬¬ 2 æ­¥ï¼šç¡®å®šâ€œåˆæ³•æ¡ä»¶â€

> çª—å£åˆæ³• â‡” æ²¡æœ‰å­—ç¬¦å‡ºç°è¶…è¿‡ 1 æ¬¡ã€‚

å°±å¯ä»¥å†™æˆï¼š

```
def is_valid(window):
    æ‰€æœ‰å­—ç¬¦é¢‘æ•°éƒ½ <= 1
```

ä½†å®é™…å®ç°é‡Œï¼Œæˆ‘ä»¬ä¸ä¼šçœŸçš„å»éå†æ‰€æœ‰å­—ç¬¦ï¼Œè€Œæ˜¯æ”¹æˆâ€œ**åªè¦æœ‰æŸä¸ªå­—ç¬¦ > 1 å°±ä¸åˆæ³•**â€çš„å†™æ³•ï¼Œç”¨ `while` æ§åˆ¶ã€‚

##### ç¬¬ 3 æ­¥ï¼šé€‰æ‹©æ•°æ®ç»“æ„ `window`

æ— é‡å¤åªå…³å¿ƒâ€œæœ‰æ²¡æœ‰â€ï¼Œä¸ç”¨å…³å¿ƒæ¬¡æ•° â†’ å¯ä»¥ç”¨ `set`ï¼›
 ä¹Ÿå¯ä»¥ç”¨ `Counter` / dictï¼Œä¸è¿‡åˆå­¦æ—¶ `set` æ›´ç›´æ¥ã€‚

é€‰æ‹© `set` åï¼š

- `add(ch, window)` = `window.add(ch)`
- `remove(s[left], window)` = `window.remove(s[left])`
- â€œä¸åˆæ³•æ¡ä»¶â€ = `s[right] in window`ï¼ˆå› ä¸ºè¿™æ ·è¯´æ˜å³ç«¯ç‚¹è¿™å­—ç¬¦å·²ç»åœ¨çª—å£é‡Œå‡ºç°è¿‡ä¸€æ¬¡ï¼‰

##### ç¬¬ 4 æ­¥ï¼šä»£å…¥æ¨¡æ¿

```
def lengthOfLongestSubstring(self, s: str) -> int:
    window = set()
    left = 0
    ans = 0

    for right, ch in enumerate(s):
        # å¦‚æœ ch å·²ç»åœ¨çª—å£é‡Œäº†ï¼Œå°±ä¸æ–­ç§»åŠ¨ left æ”¶ç¼©ï¼Œç›´åˆ°åˆ æ‰å®ƒ
        while ch in window:
            window.remove(s[left])
            left += 1

        # ç°åœ¨ ch ä¸åœ¨çª—å£ä¸­ï¼Œå¯ä»¥å®‰å…¨åŠ å…¥
        window.add(ch)

        # æ›´æ–°ç­”æ¡ˆï¼ˆå½“å‰çª—å£æ²¡æœ‰é‡å¤ï¼‰
        ans = max(ans, right - left + 1)

    return ans
```

è¿™å°±æ˜¯ä½ ä¹‹å‰åšè¿‡çš„â€œæœ€é•¿æ— é‡å¤å­ä¸²â€ï¼Œåªä¸è¿‡æˆ‘ä»¬æ˜¯ä»**æ¨¡æ¿æ¨å¯¼**å‡ºæ¥çš„ã€‚

------

#### å››ã€é€šç”¨æ¨¡æ¿ 2ï¼šå®šé•¿çª—å£ï¼ˆæ¯ä¸ªé•¿åº¦ = k çš„å­ä¸²éƒ½çœ‹ä¸€éï¼‰

> åœºæ™¯ï¼š
>
> - æ‰¾æ‰€æœ‰å¼‚ä½è¯èµ·ç‚¹
> - å›ºå®šé•¿åº¦ k çš„å­ä¸²é‡Œæ»¡è¶³æŸæ¡ä»¶çš„ä¸ªæ•°

##### Python éª¨æ¶ï¼ˆå›ºå®šçª—å£é•¿åº¦ = kï¼‰

```
k = ...
window = ...
ans = ...

for right, ch in enumerate(s):
    add(ch, window)  # æ–°å­—ç¬¦è¿›çª—å£

    # å½“çª—å£é•¿åº¦è¶…è¿‡ k æ—¶ï¼Œæ”¶ç¼©å·¦ç«¯ç‚¹
    if right >= k:
        remove(s[right - k], window)

    # å½“çª—å£é•¿åº¦åˆšå¥½ä¸º k æ—¶ï¼Œæ£€æŸ¥æ˜¯å¦æ»¡è¶³æ¡ä»¶
    if right >= k - 1:
        if is_good(window):
            è®°å½•ç­”æ¡ˆï¼ˆæ¯”å¦‚ ans.append(right-k+1)ï¼‰

return ans
```

è¿™ä¸ªéª¨æ¶ä½ ä¹Ÿå¯ä»¥èƒŒä¸‹æ¥ï¼Œä¹‹ååªæ”¹ `add/remove/is_good`ã€‚

------

#### äº”ã€ç”¨æ¨¡æ¿æ¨å¯¼ï¼šâ€œæ‰¾åˆ°æ‰€æœ‰å­—æ¯å¼‚ä½è¯â€

é¢˜æ„ï¼šåœ¨ s ä¸­ï¼Œæ‰¾æ‰€æœ‰ä¸ p ä¸ºå¼‚ä½è¯çš„å­ä¸²èµ·ç‚¹ã€‚

##### 1. çª—å£å«ä¹‰

- çª—å£å§‹ç»ˆç»´æŠ¤é•¿åº¦ = `len(p)` çš„å­ä¸² `s[left:right+1]`

##### 2. åˆæ³•æ¡ä»¶

> åˆæ³• â‡”
>
> 1. çª—å£é•¿åº¦ = len(p)
> 2. çª—å£é‡Œæ¯ä¸ªå­—ç¬¦å‡ºç°æ¬¡æ•°å’Œ p ä¸€æ ·

ç”±äºæˆ‘ä»¬ç”¨çš„æ˜¯**å®šé•¿æ¨¡æ¿**ï¼Œæ‰€ä»¥æ¡ä»¶ 1 è‡ªåŠ¨æ»¡è¶³ï¼›
 æ¡ä»¶ 2 ç”¨ `Counter` æ¯”è¾ƒï¼š

```
cnt_p = Counter(p)
window = Counter()
åˆæ³• â‡” window == cnt_p
```

##### 3. ä»£å…¥å®šé•¿æ¨¡æ¿

```
from collections import Counter

class Solution:
    def findAnagrams(self, s: str, p: str) -> List[int]:
        n, m = len(s), len(p)
        if n < m:
            return []

        cnt_p = Counter(p)
        cnt_s = Counter()
        ans = []

        for right, ch in enumerate(s):
            # 1. æ–°å­—ç¬¦è¿›å…¥çª—å£
            cnt_s[ch] += 1

            # 2. å¦‚æœé•¿åº¦è¶…è¿‡ mï¼Œæ”¶ç¼©å·¦è¾¹ï¼šç§»é™¤ s[right-m]
            if right >= m:
                out = s[right - m]
                cnt_s[out] -= 1
                if cnt_s[out] == 0:
                    del cnt_s[out]

            # 3. å½“çª—å£é•¿åº¦åˆšå¥½ç­‰äº m æ—¶ï¼Œæ£€æŸ¥æ˜¯å¦æ˜¯å¼‚ä½è¯
            if right >= m - 1:
                if cnt_s == cnt_p:
                    ans.append(right - m + 1)

        return ans
```

è¿™å°±æ˜¯ä½ åˆšåˆšåšçš„é‚£ç§å†™æ³•ï¼Œåªæ˜¯æˆ‘ä»¬æ˜¯ä»â€œå®šé•¿çª—å£æ¨¡æ¿ + Counterâ€ä¸€æ­¥æ­¥æ¨å‡ºæ¥çš„ã€‚



### 3. åŒºåˆ«å®šé•¿å’Œä¸å®šé•¿æ¨¡æ¿

è¿™ä¸ªé—®é¢˜è¯´ç™½äº†å°±æ˜¯ï¼š

> **æ»‘åŠ¨çª—å£é‡Œâ€œçª—å£é•¿åº¦è¦ä¸è¦å›ºå®šâ€**ï¼Œä»¥åŠ
>  **å›ºå®šå’Œä¸å›ºå®šçš„æ—¶å€™ï¼Œå·¦å³æŒ‡é’ˆåˆ†åˆ«æ€ä¹ˆåŠ¨ã€ä»£ç é•¿ä»€ä¹ˆæ ·ã€‚**

æˆ‘åˆ†å‡ å—è®²ï¼šå…ˆç”¨ç›´è§‰+å›¾ï¼Œå†è¯´ä»£ç æ¨¡æ¿ï¼Œå†æ€»ç»“ä»€ä¹ˆæ—¶å€™ç”¨å“ªä¸€ç§ã€‚

------

#### 1. å…ˆç”¨ç›´è§‰åŒºåˆ†ä¸€ä¸‹

##### 1.1 å®šé•¿æ»‘çª—ï¼ˆFixed-size windowï¼‰

**ç‰¹ç‚¹ï¼šçª—å£é•¿åº¦æ˜¯äº‹å…ˆç¡®å®šçš„ï¼Œä¸€ä¸ªå­—éƒ½ä¸èƒ½å¤šã€ä¹Ÿä¸èƒ½å°‘ã€‚**

- æ¯”å¦‚ï¼š
  - â€œæ‰¾å­—ç¬¦ä¸²ä¸­æ‰€æœ‰é•¿åº¦ä¸º `len(p)` çš„å­ä¸²ï¼Œçœ‹å“ªäº›æ˜¯ `p` çš„å¼‚ä½è¯â€
  - â€œæ•°ç»„ä¸­æ‰€æœ‰é•¿åº¦ä¸º `k` çš„å­æ•°ç»„ï¼Œæ±‚å®ƒä»¬çš„å’Œ/æœ€å¤§å€¼/æ»¡è¶³æ¡ä»¶çš„ä¸ªæ•°â€

åœ¨è¿™äº›é¢˜é‡Œï¼Œæ¯ä¸€ä¸ªå€™é€‰å­ä¸²çš„é•¿åº¦éƒ½æ˜¯å›ºå®šçš„ï¼š

- è¦ä¹ˆé•¿åº¦ = `len(p)`
- è¦ä¹ˆé•¿åº¦ = `k`

ä½ åšçš„äº‹æƒ…å°±æ˜¯ï¼š

> æŠŠä¸€å— **å›ºå®šå®½åº¦ = k** çš„â€œç»ç’ƒæ¿â€ä»å·¦å¾€å³æ»‘ï¼Œ
>  æ¯ä¸€æ ¼éƒ½æ£€æŸ¥ä¸€ä¸‹æ¿åº•ä¸‹è¿™æ®µ `[i, i+k-1]` æ˜¯å¦æ»¡è¶³æ¡ä»¶ã€‚

çª—å£åœ¨æ»‘åŠ¨è¿‡ç¨‹ä¸­ï¼Œ**é•¿åº¦ä¸€ç›´ä¸å˜**ã€‚

------

##### 1.2 ä¸å®šé•¿ï¼ˆå¯å˜é•¿ï¼‰æ»‘çª—ï¼ˆVariable-size windowï¼‰

**ç‰¹ç‚¹ï¼šçª—å£é•¿åº¦ä¸æ˜¯å›ºå®šçš„ï¼Œä¼šå˜é•¿ã€ä¼šå˜çŸ­ã€‚**

- æ¯”å¦‚ï¼š
  - â€œæ— é‡å¤å­—ç¬¦çš„**æœ€é•¿å­ä¸²**â€
  - â€œå’Œä¸è¶…è¿‡ `k` çš„**æœ€é•¿**å­æ•°ç»„â€
  - â€œè‡³å°‘åŒ…å«æ‰€æœ‰ç›®æ ‡å­—ç¬¦çš„**æœ€çŸ­**å­ä¸²â€

è¿™äº›é¢˜çš„å…±åŒç‚¹æ˜¯ï¼š

> ä½ ä¸çŸ¥é“ç­”æ¡ˆçš„å­ä¸²é•¿åº¦æ˜¯å¤šå°‘ï¼Œå®ƒå¯èƒ½æ˜¯ 3ï¼Œå¯èƒ½æ˜¯ 10ï¼Œå¯èƒ½æ˜¯ 100ã€‚
>  ä½ è¦åœ¨æ‰€æœ‰å¯èƒ½çš„é•¿åº¦é‡Œæ‰¾ä¸€ä¸ª**æœ€é•¿ / æœ€çŸ­**çš„ã€‚

æ‰€ä»¥çª—å£çš„é•¿åº¦è¦æ ¹æ®æ¡ä»¶åŠ¨æ€å˜åŒ–ï¼š

- å‘å³æ‰©å¼ ï¼ˆ`right++`ï¼‰â†’ å°è¯•è®©çª—å£å˜å¤§
- ä¸åˆæ³•äº† â†’ é€šè¿‡ `left++` è®©çª—å£å˜å°ï¼Œç›´åˆ°é‡æ–°åˆæ³•

çª—å£åœ¨æ»‘åŠ¨è¿‡ç¨‹ä¸­ï¼Œ**é•¿åº¦æ˜¯â€œä¼šæ¶¨ä¼šç¼©â€çš„**ã€‚

------

#### 2. å·¦å³æŒ‡é’ˆçš„â€œåŠ¨ä½œæ¨¡å¼â€åŒºåˆ«

##### 2.1 å®šé•¿æ»‘çª—ï¼šå³æŒ‡é’ˆä¸€æ­¥ä¸€æ­¥èµ°ï¼Œå·¦æŒ‡é’ˆè·Ÿç€â€œåŒ€é€Ÿèµ°â€

è®¾é•¿åº¦ = `k`ã€‚

**æ¯ç§»åŠ¨ä¸€æ¬¡å³æŒ‡é’ˆï¼Œå·¦æŒ‡é’ˆåªä¼šç§»åŠ¨ 0 æˆ– 1 æ¬¡ï¼Œå¹¶ä¸”æœ€ç»ˆä¿è¯ï¼š**

```
right - left + 1 == k
```

æœ€å¸¸è§çš„å†™æ³•ï¼š

```
k = ...
window = ...
for right, x in enumerate(nums):
    # æŠŠ x åŠ è¿›çª—å£
    add(x)

    # å¦‚æœé•¿åº¦ > kï¼Œå°±æŠŠæœ€å·¦ç«¯çš„é‚£ä¸ªç§»å‡º
    if right >= k:
        remove(nums[right - k])

    # å½“é•¿åº¦ == k æ—¶å°±å¯ä»¥æ£€æŸ¥ / æ›´æ–°ç­”æ¡ˆ
    if right >= k - 1:
        if æ¡ä»¶æ»¡è¶³:
            è®°å½•ç­”æ¡ˆï¼ˆèµ·ç‚¹æ˜¯ right-k+1ï¼‰
```

ä½ ä¼šå‘ç°ï¼š

- çª—å£é•¿åº¦æ˜¯å…ˆ**æ¶¨åˆ° k**ï¼Œä¹‹åæ¯ä¸€æ­¥éƒ½æ˜¯ï¼š
  - å³è¾¹è¿›ä¸€ä¸ª
  - å·¦è¾¹å‡ºä¸€ä¸ª
  - é•¿åº¦ä¸€ç›´ä¿æŒ k ä¸å˜

------

##### 2.2 ä¸å®šé•¿æ»‘çª—ï¼šå³æŒ‡é’ˆèµ°ä¸€æ­¥ï¼Œå·¦æŒ‡é’ˆå¯èƒ½èµ°å¾ˆå¤šæ­¥

ä¸å®šé•¿çš„å…¸å‹æ“ä½œï¼š

```
left = 0
for right, x in enumerate(nums):
    add(x)  # å³ç«¯ç‚¹è¿›æ¥

    # å¦‚æœä¸æ»¡è¶³æ¡ä»¶ï¼Œå°±ç¼©å·¦è¾¹
    while ä¸åˆæ³•:
        remove(nums[left])  # å·¦ç«¯ç‚¹ç¦»å¼€
        left += 1

    # ç°åœ¨çª—å£åˆæ³•äº†ï¼Œé•¿åº¦å¯èƒ½æ˜¯ä»»ä½•å€¼
    # æ ¹æ®é¢˜æ„æ›´æ–°â€œæœ€é•¿ / æœ€çŸ­â€ç­‰ç­”æ¡ˆ
    æ›´æ–° ans
```

ç‰¹ç‚¹ï¼š

- å³æŒ‡é’ˆæ¯æ¬¡åª +1
- å·¦æŒ‡é’ˆå¯èƒ½ä¸åŠ¨ï¼Œä¹Ÿå¯èƒ½ä¸€æ¬¡ while å¾€å‰è·³å¾ˆå¤šæ­¥
- çª—å£é•¿åº¦æ˜¯**åŠ¨æ€å˜åŒ–çš„**ï¼š
  - å˜å¤§ï¼šå…ˆæ‰©å³
  - è¿‡å¤´äº†ï¼šå†ç”¨ while ç¼©å·¦

------

#### 3. ç”¨ä¾‹å­å¯¹æ¯”æ›´ç›´è§‚ä¸€ç‚¹

##### 3.1 ä¾‹å­ Aï¼šå®šé•¿æ»‘çª—â€”â€”â€œæ‰¾æ‰€æœ‰é•¿åº¦ä¸º 3 çš„å­æ•°ç»„å’Œâ€

é¢˜ï¼šæ•°ç»„ `nums`ï¼Œè¾“å‡ºæ‰€æœ‰é•¿åº¦ä¸º 3 çš„å­æ•°ç»„çš„å’Œã€‚

**çª—å£é•¿åº¦å›ºå®š k = 3ã€‚**

```
k = 3
window_sum = 0
ans = []

for right, x in enumerate(nums):
    window_sum += x

    if right >= k:  # è¶…è¿‡3ä¸ªäº†ï¼Œè¦ç§»é™¤å·¦è¾¹çš„
        window_sum -= nums[right - k]

    if right >= k - 1:  # å½“å‰çª—å£é•¿åº¦åˆšå¥½ä¸º3
        ans.append(window_sum)
```

çª—å£é•¿åº¦ï¼šä»å°äº3æ¶¨åˆ°3ï¼Œç„¶åå§‹ç»ˆä¿æŒ 3ã€‚

------

##### 3.2 ä¾‹å­ Bï¼šä¸å®šé•¿æ»‘çª—â€”â€”â€œå’Œä¸è¶…è¿‡ k çš„æœ€é•¿å­æ•°ç»„é•¿åº¦â€

é¢˜ï¼š`nums` ä¸­æ‰¾**å’Œ â‰¤ K** çš„**æœ€é•¿å­æ•°ç»„**é•¿åº¦ï¼ˆå‡è®¾å…¨ä¸ºéè´Ÿæ•°æ–¹ä¾¿è®¨è®ºï¼‰ã€‚

**çª—å£é•¿åº¦ä¸å›ºå®š**ï¼Œç›®æ ‡æ˜¯æ‰¾åˆ°â€œæ»¡è¶³æ¡ä»¶çš„æœ€é•¿é•¿åº¦â€ã€‚

```
left = 0
window_sum = 0
ans = 0

for right, x in enumerate(nums):
    window_sum += x

    # å’Œ > K æ—¶ä¸åˆæ³•ï¼Œéœ€è¦ç¼©å°çª—å£
    while window_sum > K:
        window_sum -= nums[left]
        left += 1

    # åˆ°è¿™é‡Œæ—¶ï¼Œçª—å£å’Œ <= Kï¼Œåˆæ³•
    ans = max(ans, right - left + 1)

return ans
```

å¯ä»¥çœ‹åˆ°ï¼š

- ä¸€ç›´æ‰©å³ï¼Œçª—å£å˜é•¿
- ä¸€æ—¦è¿åâ€œå’Œ â‰¤ Kâ€ï¼Œå°±ç”¨ while æŠŠå·¦è¾¹æŠ›æ‰ä¸€äº› â†’ çª—å£å˜çŸ­
- é•¿åº¦æ˜¯**åŠ¨æ€**çš„ï¼Œæœ€åæˆ‘ä»¬ä»æ‰€æœ‰åˆæ³•é•¿åº¦é‡Œæ‰¾æœ€å¤§å€¼

------

#### 4. ä»€ä¹ˆæ—¶å€™ç”¨â€œå®šé•¿â€ï¼Œä»€ä¹ˆæ—¶å€™ç”¨â€œä¸å®šé•¿â€ï¼Ÿ

å¯ä»¥ç”¨å‡ ä¸ªâ€œå°åˆ¤æ–­â€å¸®ä½ é€‰ï¼š

##### âœ” å…¸å‹ç”¨â€œå®šé•¿â€çš„é¢˜å‹

1. **æ˜ç¡®è¯´äº†â€œå›ºå®šé•¿åº¦ k / len(p)â€ï¼š**
   - æ‰¾æ‰€æœ‰é•¿åº¦ä¸º `len(p)` çš„å­ä¸²æ˜¯ä¸æ˜¯å¼‚ä½è¯ï¼ˆ438 é¢˜ï¼‰
   - â€œæ¯ä¸ªé•¿åº¦ä¸º k çš„å­æ•°ç»„çš„å¹³å‡å€¼ / å’Œ / æœ€å¤§å€¼â€
2. **ä½ è¦æšä¸¾çš„æ˜¯ï¼šæ‰€æœ‰å›ºå®šé•¿åº¦çš„çª—å£ï¼Œæ¯ä¸ªéƒ½æ£€æŸ¥ä¸€ä¸‹ï¼š**
   - â€œé•¿åº¦å›ºå®šä¸º 10 çš„å­ä¸²ä¸­ï¼Œæ•°å­—ä¸ªæ•°æœ€å¤šçš„æ˜¯å“ªä¸ªâ€
   - â€œé•¿åº¦å›ºå®šä¸º k çš„å­æ•°ç»„ä¸­ï¼Œè´Ÿæ•°æ•°é‡æœ€å°‘çš„æ˜¯å“ªä¸ªâ€

> ç‰¹å¾ï¼š
>  ğŸ‘‰ é¢˜ç›®é‡Œâ€œå€™é€‰å­ä¸²çš„é•¿åº¦æ˜¯æ˜ç¡®ç»™å®šçš„ï¼Œç­”æ¡ˆä¸æ˜¯é•¿åº¦ï¼Œæ˜¯å­ä¸²çš„ä½ç½®/æ€§è´¨/è®¡æ•°â€ã€‚

------

##### âœ” å…¸å‹ç”¨â€œä¸å®šé•¿â€çš„é¢˜å‹

1. **æ±‚â€œæœ€é•¿ / æœ€çŸ­â€å­ä¸²/å­æ•°ç»„ï¼š**
   - æœ€é•¿æ— é‡å¤å­ä¸²
   - å’Œ â‰¤ k çš„æœ€é•¿å­æ•°ç»„
   - å«æœ‰æ‰€æœ‰ç›®æ ‡å­—ç¬¦çš„æœ€çŸ­å­ä¸²ï¼ˆæœ€å°è¦†ç›–å­ä¸²ï¼‰
2. **æ¡ä»¶æ˜¯â€œçª—å£å†…æŸå±æ€§è¦æ»¡è¶³/ä¸è¶…è¿‡â€ï¼Œä½†æ²¡è§„å®šçª—å£é•¿åº¦ï¼š**
   - â€œçª—å£é‡Œä¸åŒå­—ç¬¦ç§ç±» â‰¤ K çš„æœ€é•¿å­ä¸²â€
   - â€œçª—å£é‡ŒæŸä¸ªç»Ÿè®¡é‡ â‰¥ / â‰¤ æŸå€¼æ—¶ï¼Œæƒ³è¦æœ€çŸ­ / æœ€é•¿â€

> ç‰¹å¾ï¼š
>  ğŸ‘‰ é¢˜ç›®é‡Œâ€œç­”æ¡ˆæœ¬èº«å°±æ˜¯é•¿åº¦â€ï¼Œä¸”é¢˜ç›®æ²¡æœ‰ç»™å®šå…·ä½“é•¿åº¦ï¼Œè€Œæ˜¯ç»™äº†ä¸€ä¸ªæ¡ä»¶ï¼šåªè¦æ»¡è¶³æ¡ä»¶å°±è¡Œï¼Œç„¶ååœ¨æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„é‡Œé¢é€‰æœ€å¤§/æœ€å°ã€‚

------

#### 5. å†ç”¨ä¸€å¥è¯æ€»ç»“ä¸¤è€…åŒºåˆ«ï¼ˆæ€è·¯ + ä»£ç ï¼‰

**æ€è·¯ä¸Šï¼š**

- **å®šé•¿æ»‘çª—**ï¼š

  > é•¿åº¦æ˜¯å›ºå®šçš„ ğŸ‘‰ åªè¦ä¿è¯ `right - left + 1 == k`ã€‚
  >  æ¯ä¸ªé•¿åº¦ä¸º k çš„çª—å£éƒ½æšä¸¾ä¸€éï¼Œçœ‹å®ƒå¥½ä¸å¥½ã€‚

- **ä¸å®šé•¿æ»‘çª—**ï¼š

  > é•¿åº¦æ˜¯æœªçŸ¥çš„ ğŸ‘‰ é€šè¿‡æ‰©å³ + æ”¶å·¦åŠ¨æ€è°ƒèŠ‚ã€‚
  >  ç›®æ ‡æ˜¯åœ¨æ‰€æœ‰â€œåˆæ³•çª—å£â€é‡Œæ‰¾â€œæœ€é•¿ / æœ€çŸ­â€ã€‚

**ä»£ç é£æ ¼ä¸Šï¼š**

- å®šé•¿ï¼š

  - ä¸€èˆ¬ä¸ä¼šæœ‰ `while` æ”¶ç¼©ï¼Œåªåœ¨ `right >= k` æ—¶å»æ‰ä¸€ä¸ªæœ€å·¦å…ƒç´ ï¼›

  - å¸¸è§ç»“æ„æ˜¯ï¼š

    ```
    add(right)
    if right >= k:
        remove(right-k)
    if right >= k-1:
        æ£€æŸ¥ / è®°å½•
    ```

- ä¸å®šé•¿ï¼š

  - ä¸€å®šæœ‰ `while`ï¼Œä¸åœæ”¶ç¼©å·¦è¾¹ï¼Œç›´åˆ°çª—å£é‡æ–°åˆæ³•ï¼›

  - å¸¸è§ç»“æ„æ˜¯ï¼š

    ```
    add(right)
    while ä¸åˆæ³•:
        remove(left)
        left += 1
    æ›´æ–°æœ€é•¿ / æœ€çŸ­ç­”æ¡ˆ
    ```



## 2. ä»£ç 

### æ–¹æ³•ä¸€ï¼šå®šé•¿æ»‘çª—

```python
class Solution:
    def findAnagrams(self, s: str, p: str) -> List[int]:
        ans = []
        cnt_p = Counter(p)  # ç»Ÿè®¡ p çš„æ¯ç§å­—æ¯çš„å‡ºç°æ¬¡æ•°
        cnt_s = Counter()  # ç»Ÿè®¡ s çš„é•¿ä¸º len(p) çš„å­ä¸² s' çš„æ¯ç§å­—æ¯çš„å‡ºç°æ¬¡æ•°
        for right, c in enumerate(s):
            cnt_s[c] += 1  # å³ç«¯ç‚¹å­—æ¯è¿›å…¥çª—å£
            left = right - len(p) + 1
            if left < 0:  # çª—å£é•¿åº¦ä¸è¶³ len(p)
                continue
            if cnt_s == cnt_p:  # s' å’Œ p çš„æ¯ç§å­—æ¯çš„å‡ºç°æ¬¡æ•°éƒ½ç›¸åŒ
                ans.append(left)  # s' å·¦ç«¯ç‚¹ä¸‹æ ‡åŠ å…¥ç­”æ¡ˆ
            out = s[left]
            cnt_s[out] -= 1  # å·¦ç«¯ç‚¹å­—æ¯ç¦»å¼€çª—å£
            if cnt_s[out] == 0:
                del cnt_s[out]  # æ³¨ï¼šç›®å‰åŠ›æ‰£çš„ Python ç‰ˆæœ¬æ˜¯ 3.11ï¼Œä¸åˆ é™¤ä¹Ÿå¯ä»¥ï¼Œä½†åœ¨ 3.12 ä¸­éœ€è¦åˆ é™¤
        return ans
```

#### è¿™ä¸‰è¡Œåˆ°åº•åœ¨å¹²ä»€ä¹ˆï¼Ÿ

```
out = s[left]
cnt_s[out] -= 1  # å·¦ç«¯ç‚¹å­—æ¯ç¦»å¼€çª—å£
if cnt_s[out] == 0:
    del cnt_s[out]  # ç›®å‰ LeetCode ç”¨çš„ Python 3.11 ä¸åˆ ä¹Ÿè¡Œï¼Œ3.12 é‡Œå»ºè®®åˆ 
```

ä¸€è¡Œä¸€è¡Œæ¥ã€‚

#### 2.1 `out = s[left]`

ç°åœ¨è¿™ä¸€è½®çš„çª—å£æ˜¯ `[left, right]`ï¼Œé•¿åº¦æ˜¯ `m`ã€‚
 ä¸‹ä¸€è½®çš„æ—¶å€™ï¼š

- å³ç«¯ç‚¹ä¼šå˜æˆ `right+1`
- å·¦ç«¯ç‚¹åº”è¯¥å˜æˆ `left+1`ï¼ˆæ‰ä¿è¯é•¿åº¦ä»ç„¶æ˜¯ mï¼‰

æ‰€ä»¥å½“å‰è¿™ä¸ª `s[left]`ï¼Œåœ¨ä¸‹ä¸€è½®å°±**ä¸å†å±äºçª—å£**äº†ï¼Œå®ƒæ˜¯â€œè¢«æ»‘å‡ºçª—å£çš„å­—ç¬¦â€ã€‚

æˆ‘ä»¬ç»™å®ƒèµ·ä¸ªåå­—å« `out`ï¼Œè¡¨ç¤º **â€œè¦å‡ºçª—å£çš„é‚£ä¸ªå­—ç¬¦â€**ã€‚

#### 2.2`if cnt_s[out] == 0: del cnt_s[out]` ä¸ºå•¥è¦åˆ ï¼Ÿ

è¿™ä¸€æ­¥æ˜¯ä½ æœ€è¿·æƒ‘çš„åœ°æ–¹ï¼Œæ ¸å¿ƒç‚¹æœ‰ä¸¤ä¸ªï¼š

1. **é€»è¾‘ä¸Šï¼š**
    æˆ‘ä»¬å¸Œæœ› `cnt_s` ä¸­åªä¿ç•™â€œçª—å£ä¸­çœŸæ­£å­˜åœ¨çš„å­—ç¬¦â€ï¼›
    æŸä¸ªå­—ç¬¦å¦‚æœæ¬¡æ•°å˜æˆ 0ï¼Œå…¶å®å°±æ˜¯â€œè¿™ä¸ªå­—ç¬¦åœ¨çª—å£é‡Œå·²ç»ä¸å­˜åœ¨äº†â€ï¼Œåˆ æ‰å®ƒæ˜¯æœ€å¹²å‡€çš„åšæ³•ã€‚

2. **å’Œ `cnt_p` åšæ¯”è¾ƒæ—¶æ›´è‡ªç„¶ï¼š**

   æˆ‘ä»¬æ˜¯è¿™æ ·åˆ¤æ–­ä¸€ä¸ªçª—å£æ˜¯ä¸æ˜¯å¼‚ä½è¯çš„ï¼š

   ```
   if cnt_s == cnt_p:
       ans.append(left)
   ```

   - `cnt_p = Counter(p)`ï¼ŒåªåŒ…å« `p` ä¸­å‡ºç°è¿‡çš„å­—ç¬¦ï¼Œæ¬¡æ•°éƒ½ > 0ï¼›
   - å¦‚æœ `cnt_s` ä¸­æœ‰ä¸€äº›é”®æ˜¯ `0`ï¼Œæ¯”å¦‚ `{'a':1, 'b':1, 'x':0}`ï¼Œ
      é‚£åœ¨ä¸åŒ Python ç‰ˆæœ¬é‡Œï¼š
     - æœ‰çš„ç‰ˆæœ¬ä¼šæŠŠ `0` å½“æ™®é€šé”®ï¼š
        `Counter(a=1, b=1, x=0) == Counter(a=1, b=1)` å¯èƒ½æ˜¯ **False**ï¼›
     - æœ‰çš„ç‰ˆæœ¬ï¼ˆæ¯”å¦‚å½“å‰ LeetCode ç”¨çš„ 3.11ï¼‰åœ¨ `Counter` çš„æ¯”è¾ƒæ—¶ï¼Œä¼šæŠŠç¼ºå¤±çš„å½“ä½œ 0ï¼Œçœ‹æˆ **True**ã€‚[Python documentation](https://docs.python.org/3/library/collections.html?utm_source=chatgpt.com)

   å®˜æ–¹æ–‡æ¡£é‡Œå°±è¯´äº†ï¼Œä» 3.10 å¼€å§‹ï¼Œ`Counter` çš„ç›¸ç­‰æ¯”è¾ƒä¼šæŠŠâ€œç¼ºå¤±çš„å…ƒç´ â€å½“ `0` çœ‹å¾…ï¼Œæ‰€ä»¥ï¼š

   ```
   Counter(a=3) == Counter(a=3, b=0)   # True
   ```

   ä½†ä¸æ’é™¤åœ¨æŸäº›ç¯å¢ƒ/æœªæ¥ç‰ˆæœ¬é‡Œï¼Œè¡Œä¸ºæ›´æ¥è¿‘æ™®é€š dictï¼ˆè¦å®Œå…¨ä¸€æ ·æ‰ç®—ç›¸ç­‰ï¼‰ï¼Œæ‰€ä»¥æ‰ä¼šæœ‰ LeetCode è¿™å¥æ³¨é‡Šï¼š

   > â€œç›®å‰åŠ›æ‰£ Python æ˜¯ 3.11ï¼Œä¸åˆ é™¤ä¹Ÿå¯ä»¥ï¼Œåœ¨ 3.12 ä¸­éœ€è¦åˆ é™¤â€

   â€”â€”ä»–ä»¬çš„æ„æ€æ˜¯ï¼š
    **ç¨³å¦¥åšæ³•**æ˜¯ï¼šå½“è®¡æ•°ä¸º 0 æ—¶ï¼ŒæŠŠè¿™ä¸ªé”®åˆ æ‰ï¼Œè¿™æ · `cnt_s` çš„é”®é›†åˆå°±å’Œ `cnt_p` å®Œå…¨ä¸€æ ·ï¼Œ`==` åˆ¤æ–­ä¸ä¼šæœ‰æ­§ä¹‰ï¼Œä¹Ÿæ›´ç¬¦åˆâ€œçª—å£é‡Œæœ‰å“ªäº›å­—ç¬¦â€çš„ç›´è§‚å«ä¹‰ã€‚

ä½ å¯ä»¥è¿™ä¹ˆç†è§£è¿™ä¸‰è¡Œçš„æ•´ä½“è¯­ä¹‰ï¼š

> â€œçª—å£å‘å³æ»‘åŠ¨ä¸€æ ¼ï¼ŒæŠŠæœ€å·¦è¾¹çš„é‚£ä¸ªå­—ç¬¦ä»çª—å£ä¸­åˆ æ‰ã€‚å¦‚æœåˆ å®Œè¿™ä¸ªå­—ç¬¦åï¼Œå®ƒåœ¨çª—å£é‡Œå·²ç»å®Œå…¨ä¸å­˜åœ¨äº†ï¼Œå°±ä» `Counter` é‡ŒæŠŠè¿™ä¸ªé”®ä¹Ÿåˆ é™¤ã€‚â€

## æ–¹æ³•äºŒï¼šä¸å®šé•¿æ»‘çª—ï¼ˆé•¿åº¦æ ¹æ®â€œè¶…æ ‡â€åŠ¨æ€å˜åŒ–ï¼‰

è¿™ä¸¤ç§åšæ³•**æœ¬è´¨ä¸Šéƒ½æ˜¯æ»‘åŠ¨çª—å£**ï¼Œåªæ˜¯ï¼š

- æ–¹æ³•ä¸€ï¼šçª—å£é•¿åº¦**ä¸€ç›´ç­‰äº `len(p)`**ï¼Œæ¯ä¸ªçª—å£éƒ½å’Œ `p` çš„é¢‘æ•°åšä¸€æ¬¡â€œå®Œæ•´ä½“æ£€â€ã€‚
- æ–¹æ³•äºŒï¼šçª—å£é•¿åº¦**ä¼šå˜é•¿å˜çŸ­**ï¼Œåªç»´æŠ¤ä¸€ä¸ªâ€œå·®å€¼è®¡æ•°å™¨â€ï¼Œé ã€Œä¸è¶…æ ‡ã€+ã€Œé•¿åº¦åˆšå¥½ã€æ¥åˆ¤æ–­æ˜¯å¼‚ä½è¯ã€‚

ä½ å¯ä»¥æŠŠå®ƒä»¬ç†è§£æˆï¼š

> æ–¹æ³•ä¸€ï¼š**æ¯æ¬¡éƒ½é‡æ–°å¯¹çª—å£åšä½“æ£€**ã€‚
>  æ–¹æ³•äºŒï¼š**ä¸€ç›´æ‹¿ç€ä¸€å¼ â€œåé¢å¡â€ï¼Œå®æ—¶è®°è´¦ï¼Œæ°¸è¿œä¸è®©è¶…æ ‡ã€‚**

**çª—å£é•¿åº¦æ˜¯å˜åŒ–çš„ï¼š**

- ä¸€å¼€å§‹å¾ˆçŸ­ï¼Œå³ç«¯è¿›æ¥ã€æ²¡è¶…æ ‡ï¼Œå°±è‡ªç„¶å˜é•¿
- ä¸€æ—¦æŸä¸ªå­—ç¬¦è¶…æ ‡ï¼Œå°±ä¸æ–­æ”¶ç¼©å·¦ç«¯ï¼Œå˜çŸ­
- ä½†æ€»ä½“ä¿è¯ï¼š
  - çª—å£ä¸­æ¯ç§å­—æ¯æ•° **â‰¤** p ä¸­å¯¹åº”çš„æ•°é‡
  - åŒæ—¶é•¿åº¦ **â‰¤ len(p)**
  - è¾¾åˆ° **== len(p)** çš„é‚£ä¸€åˆ»ï¼Œå°±å¿…ç„¶æ˜¯å®Œå…¨åŒ¹é…

è¿™ä¸€å¥—å°±æ˜¯å…¸å‹çš„â€œ**ä¸å®šé•¿çª—å£ï¼Œé€šè¿‡æ¡ä»¶æ§åˆ¶é•¿åº¦**â€ã€‚

```python
class Solution:
    def findAnagrams(self, s: str, p: str) -> List[int]:
        ans = []
        cnt = Counter(p)  # ç»Ÿè®¡ p çš„æ¯ç§å­—æ¯çš„å‡ºç°æ¬¡æ•°
        left = 0
        for right, c in enumerate(s):
            cnt[c] -= 1  # å³ç«¯ç‚¹å­—æ¯è¿›å…¥çª—å£
            while cnt[c] < 0:  # å­—æ¯ c å¤ªå¤šäº†
                cnt[s[left]] += 1  # å·¦ç«¯ç‚¹å­—æ¯ç¦»å¼€çª—å£
                left += 1
            if right - left + 1 == len(p):  # s' å’Œ p çš„æ¯ç§å­—æ¯çš„å‡ºç°æ¬¡æ•°éƒ½ç›¸åŒ
                ans.append(left)  # s' å·¦ç«¯ç‚¹ä¸‹æ ‡åŠ å…¥ç­”æ¡ˆ
        return ans
```